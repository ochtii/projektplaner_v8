<!-- location: app/templates/admin/debug_settings.html -->
{% extends "base.html" %}
{% block title %}Debug-Einstellungen{% endblock %}

{% block content %}
<div class="page-header">
    <h2><i class="fa-solid fa-sliders"></i> Debug-Einstellungen</h2>
</div>

<div class="admin-sections">
    <div class="admin-section">
        <h3>Live Logging</h3>
        <p class="form-hint">Steuern Sie die Anzeige von Log-Nachrichten in Echtzeit. Alle Einstellungen hier werden lokal in Ihrem Browser gespeichert.</p>

        <!-- Hauptschalter für das Logging -->
        <div class="form-group toggle-switch">
            <label for="logs-enabled-toggle">Live Logs generell aktivieren</label>
            <label class="switch">
                <input type="checkbox" class="setting-switch" id="logs-enabled-toggle" data-setting="logs_enabled">
                <span class="slider round"></span>
            </label>
        </div>

        <hr class="section-divider">

        <!-- Panel, das nur bei aktivem Logging sichtbar ist -->
        <div id="log-settings-panel" style="display: none;">
            
            <div class="admin-subsection">
                <h4>Anzeige-Optionen</h4>
                <div class="form-group toggle-switch">
                    <label for="console-toggle">Eigene Log-Konsole anzeigen</label>
                    <label class="switch">
                        <input type="checkbox" class="setting-switch" id="console-toggle" data-setting="show_log_console">
                        <span class="slider round"></span>
                    </label>
                </div>
                
                <hr class="option-divider">
                
                <div class="form-group toggle-switch">
                    <label for="browser-console-toggle">Logs auch in Browser-Konsole (F12) ausgeben</label>
                    <label class="switch">
                        <input type="checkbox" class="setting-switch" id="browser-console-toggle" data-setting="log_to_browser_console">
                        <span class="slider round"></span>
                    </label>
                </div>
                
                <hr class="option-divider">
                
                <!-- NEU: Zusätzliche Anzeige-Einstellungen -->
                <div class="form-group toggle-switch">
                    <label for="autoscroll-toggle">Auto-Scroll in Konsole</label>
                    <label class="switch">
                        <input type="checkbox" class="setting-switch" id="autoscroll-toggle" data-setting="log_autoscroll_enabled">
                        <span class="slider round"></span>
                    </label>
                </div>
                
                <hr class="option-divider">
                
                <div class="form-group toggle-switch">
                    <label for="reverse-logs-toggle">Log-Reihenfolge umkehren (neueste oben)</label>
                    <label class="switch">
                        <input type="checkbox" class="setting-switch" id="reverse-logs-toggle" data-setting="log_order_reversed">
                        <span class="slider round"></span>
                    </label>
                </div>
            </div>

            <hr class="section-divider">

            <div class="admin-subsection">
                <h4>Log-Typen</h4>
                <p class="form-hint">Wählen Sie aus, welche Arten von Logs angezeigt werden sollen.</p>
                <div class="log-filter-grid-page">
                    <label class="custom-checkbox">
                        <input type="checkbox" class="setting-switch log-filter" id="log-info" data-setting="log_info" checked>
                        <span class="checkbox-box"></span>
                        <span class="checkbox-label">Info</span>
                    </label>
                    <label class="custom-checkbox">
                        <input type="checkbox" class="setting-switch log-filter" id="log-warn" data-setting="log_warn" checked>
                        <span class="checkbox-box"></span>
                        <span class="checkbox-label">Warnungen</span>
                    </label>
                    <label class="custom-checkbox">
                        <input type="checkbox" class="setting-switch log-filter" id="log-err" data-setting="log_err" checked>
                        <span class="checkbox-box"></span>
                        <span class="checkbox-label">Fehler</span>
                    </label>
                    <label class="custom-checkbox">
                        <input type="checkbox" class="setting-switch log-filter" id="log-api-req" data-setting="log_api_req" checked>
                        <span class="checkbox-box"></span>
                        <span class="checkbox-label">API Anfragen</span>
                    </label>
                    <label class="custom-checkbox">
                        <input type="checkbox" class="setting-switch log-filter" id="log-api-ans" data-setting="log_api_ans" checked>
                        <span class="checkbox-box"></span>
                        <span class="checkbox-label">API Antworten</span>
                    </label>
                    <label class="custom-checkbox">
                        <input type="checkbox" class="setting-switch log-filter" id="log-activity" data-setting="log_activity" checked>
                        <span class="checkbox-box"></span>
                        <span class="checkbox-label">Aktivitäten</span>
                    </label>
                </div>
            </div>
            
            <hr class="section-divider">
            
            <!-- Farbeinstellungen Sektion -->
            <div class="admin-subsection">
                <h4>Log-Einstellungen</h4>
                <p class="form-hint">
                    Passen Sie die Farben für verschiedene Log-Typen und die Konsole an. 
                    <strong>Live-Update:</strong> Änderungen werden sofort angezeigt während Sie die Farbe auswählen.
                    <br><small><i class="fa-solid fa-keyboard"></i> Tipp: Drücken Sie <kbd>ESC</kbd> um Änderungen rückgängig zu machen.</small>
                </p>
                
                <!-- Konsolen-Styling Bereich -->
                <h5>Konsolen Styling</h5>
                <div class="log-color-settings console-styling">
                    <div class="color-setting console-background">
                        <label for="color-console-bg">Konsolen-Hintergrund:</label>
                        <input type="color" id="color-console-bg" data-log-type="console_background" value="#282c34" class="color-picker">
                        <div class="console-preview" data-type="console_background">
                            <span class="preview-time">[12:34:56]</span>
                            <span class="preview-type">[CONSOLE]</span>
                            <span class="preview-message">Konsolen-Hintergrund</span>
                        </div>
                    </div>
                    <div class="color-setting">
                        <label for="color-log-text">Log-Text:</label>
                        <input type="color" id="color-log-text" data-log-type="log_text" value="#abb2bf" class="color-picker">
                        <div class="console-preview" data-type="log_text">
                            <span class="preview-time">[12:34:56]</span>
                            <span class="preview-type">[TEXT]</span>
                            <span class="preview-message">Beispiel Log-Text</span>
                        </div>
                    </div>
                    <div class="color-setting">
                        <label for="color-timestamp">Zeitstempel:</label>
                        <input type="color" id="color-timestamp" data-log-type="timestamp" value="#8892b0" class="color-picker">
                        <div class="console-preview" data-type="timestamp">
                            <span class="preview-time">[12:34:56]</span>
                            <span class="preview-type">[TIME]</span>
                            <span class="preview-message">Zeitstempel-Farbe</span>
                        </div>
                    </div>
                    <div class="color-setting header-background">
                        <label for="color-header">Header-Hintergrund:</label>
                        <input type="color" id="color-header" data-log-type="header_bg" value="#1e2127" class="color-picker">
                        <div class="console-preview header-preview" data-type="header_bg">
                            <span class="preview-header">Log-Konsole Header</span>
                        </div>
                    </div>
                    <div class="color-setting header-text">
                        <label for="color-header-text">Header-Schrift:</label>
                        <input type="color" id="color-header-text" data-log-type="header_text" value="#ffffff" class="color-picker">
                        <div class="console-preview header-preview" data-type="header_text">
                            <span class="preview-header">Header-Text</span>
                        </div>
                    </div>
                </div>
                
                <hr class="color-section-divider">
                
                <h5>Log-Typ Farben</h5>
                <div class="log-color-settings">
                    <div class="color-setting">
                        <label for="color-info">Info:</label>
                        <input type="color" id="color-info" data-log-type="info" value="#3b82f6" class="color-picker">
                        <div class="console-preview" data-type="info">
                            <span class="preview-time">[12:34:56]</span>
                            <span class="preview-type">[INFO]</span>
                            <span class="preview-message">Beispiel Info-Log</span>
                        </div>
                    </div>
                    <div class="color-setting">
                        <label for="color-warn">Warnungen:</label>
                        <input type="color" id="color-warn" data-log-type="warn" value="#f59e0b" class="color-picker">
                        <div class="console-preview" data-type="warn">
                            <span class="preview-time">[12:34:56]</span>
                            <span class="preview-type">[WARN]</span>
                            <span class="preview-message">Beispiel Warnung</span>
                        </div>
                    </div>
                    <div class="color-setting">
                        <label for="color-err">Fehler:</label>
                        <input type="color" id="color-err" data-log-type="err" value="#ef4444" class="color-picker">
                        <div class="console-preview" data-type="err">
                            <span class="preview-time">[12:34:56]</span>
                            <span class="preview-type">[ERR]</span>
                            <span class="preview-message">Beispiel Fehler</span>
                        </div>
                    </div>
                    <div class="color-setting">
                        <label for="color-api-req">API Anfragen:</label>
                        <input type="color" id="color-api-req" data-log-type="api_req" value="#8b5cf6" class="color-picker">
                        <div class="console-preview" data-type="api_req">
                            <span class="preview-time">[12:34:56]</span>
                            <span class="preview-type">[API-REQ]</span>
                            <span class="preview-message">Beispiel API Request</span>
                        </div>
                    </div>
                    <div class="color-setting">
                        <label for="color-api-ans">API Antworten:</label>
                        <input type="color" id="color-api-ans" data-log-type="api_ans" value="#a855f7" class="color-picker">
                        <div class="console-preview" data-type="api_ans">
                            <span class="preview-time">[12:34:56]</span>
                            <span class="preview-type">[API-ANS]</span>
                            <span class="preview-message">Beispiel API Response</span>
                        </div>
                    </div>
                    <div class="color-setting">
                        <label for="color-database">Datenbank:</label>
                        <input type="color" id="color-database" data-log-type="database" value="#10b981" class="color-picker">
                        <div class="console-preview" data-type="database">
                            <span class="preview-time">[12:34:56]</span>
                            <span class="preview-type">[DB]</span>
                            <span class="preview-message">Beispiel Datenbank-Log</span>
                        </div>
                    </div>
                    <div class="color-setting">
                        <label for="color-activity">Aktivitäten:</label>
                        <input type="color" id="color-activity" data-log-type="activity" value="#6b7280" class="color-picker">
                        <div class="console-preview" data-type="activity">
                            <span class="preview-time">[12:34:56]</span>
                            <span class="preview-type">[ACTIVITY]</span>
                            <span class="preview-message">Beispiel Aktivitäts-Log</span>
                        </div>
                    </div>
                </div>
                
                <!-- Reset-Button für alle Farben -->
                <div class="color-controls">
                    <button type="button" id="reset-colors" class="btn btn-warning">
                        <i class="fa-solid fa-undo"></i> Alle Farben zurücksetzen
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Reset Confirmation Modal -->
<div id="reset-confirm-modal" class="reset-confirm-modal">
    <div class="reset-confirm-content">
        <h4><i class="fa-solid fa-triangle-exclamation"></i> Farbe zurücksetzen</h4>
        <p id="reset-confirm-text">Möchten Sie diese Farbe wirklich auf den Standardwert zurücksetzen?</p>
        <div class="reset-confirm-buttons">
            <button type="button" id="reset-confirm-yes" class="btn btn-warning">
                <i class="fa-solid fa-check"></i> Ja, zurücksetzen
            </button>
            <button type="button" id="reset-confirm-no" class="btn btn-secondary">
                <i class="fa-solid fa-times"></i> Abbrechen
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/admin_settings.js') }}"></script>
{% endblock %}
